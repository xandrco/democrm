# DemoCRM

## Описание проекта

DemoCRM - это мини система управления заявками для тестогого задания. Система предоставляет удобный интерфейс для работы с заявками, включая возможность фильтрации, сортировки, поиска, изменения статусов и добавления комментариев.

## Технологии

Проект разработан с использованием следующих технологий:

### Backend
- Laravel 12 (PHP)
- MySQL / SQLITE
- RESTful API

### Frontend
- React (JS)
- TailwindCSS

## Функциональные возможности

- Авторизация и регистрация админов (Sanctum и API токены)
- Создание, просмотр, редактирование и удаление заявок
- Фильтрация заявок по различным параметрам
- Поиск заявок по названию и email
- Изменение статусов заявок (Новая, В обработке, Решена, Отклонена)
- Система комментариев к заявкам
- Экспорт списка заявок в CSV
- Отображение метаданных о заявках (IP, браузер, источник)

## Установка и настройка

### Требования
- PHP 8.2+
- Composer
- Node.js 14+ и npm/yarn
- MySQL 5+

### Шаги установки

1. Клонировать репозиторий:
```bash
git clone https://github.com/xandrco/democrm
cd democrm
```

2. Установить зависимости PHP:
```bash
composer install
```

3. Установить зависимости JavaScript:
```bash
npm install
```

4. Создать и настроить файл окружения:
```bash
cp .env.example .env
php artisan key:generate
```

5. Настроить подключение к базе данных в файле `.env`

6. Запустить миграции и заполнить базу начальными данными:
```bash
php artisan migrate --seed
```

7. Собрать фронтенд-ресурсы:
```bash
npm run dev
```

8. Запустить локальный сервер разработки:
```bash
php artisan serve
```

## Миграции и сидеры

### Миграции

Проект содержит следующие основные миграции:

- `create_users_table` - таблица пользователей
- `create_applications_table` - таблица заявок с полями name, email, message, status и др.
- `create_comments_table` - таблица комментариев к заявкам

Для выполнения миграций используйте команду:
```bash
php artisan migrate
```

### Сидеры

В проекте настроены следующие сидеры для заполнения базы тестовыми данными:

- `UserSeeder` - создает демо-аккаунты пользователей
- `ApplicationSeeder` - создает тестовые заявки
- `CommentSeeder` - создает комментарии к заявкам

Для запуска всех сидеров используйте команду:
```bash
php artisan db:seed
```

## Демо-аккаунты

После запуска сидеров будут доступны следующие демо-аккаунты:

**Администратор**
   - Email: admin@democrm.com
   - Пароль: password

**Администратор 2**
   - Email: admin2@democrm.com
   - Пароль: password

## API документация

API-документация доступна в файле [api-documentation.md](api-documentation.md) в корне проекта.

Система предоставляет RESTful API для работы с заявками и комментариями, включая следующие основные эндпоинты:

- Аутентификация: `/api/login`, `/api/register`, `/api/logout`
- Заявки: `/api/applications`
- Комментарии: `/api/applications/{id}/comments`

Все запросы, кроме авторизации, требуют передачи токена в заголовке запроса.

## Разработка

### Запуск фронтенда в режиме разработки

```bash
npm run dev
```

## Структура проекта

### Backend

- `app/Models` - модели данных (Application, Comment, User)
- `app/Http/Controllers` - контроллеры API
- `app/Http/Middleware` - промежуточное ПО, включая аутентификацию
- `database/migrations` - миграции базы данных
- `database/seeders` - сидеры для заполнения базы данными
- `routes/api.php` - определение API-маршрутов

### Frontend

- `resources/js/components` - React-компоненты
- `resources/js/context` - контексты для управления состоянием
- `resources/js/utils` - вспомогательные функции
